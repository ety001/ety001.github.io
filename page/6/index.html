<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon.ico">
  <link rel="mask-icon" href="/img/favicon.ico" color="#222">
  <link rel="manifest" href="/site.webmanifest">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.akawa.ink","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ETY001的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Akawa">
<meta property="og:url" content="https://blog.akawa.ink/page/6/index.html">
<meta property="og:site_name" content="Akawa">
<meta property="og:description" content="ETY001的博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ETY001">
<meta property="article:tag" content="ETY001, akawa, php, vuejs, javascript, docker, steemit, bitshares">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://blog.akawa.ink/page/6/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/6/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Akawa - ETY001的博客</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-60YZJHHP9K"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-60YZJHHP9K","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>







<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7536831447654223" crossorigin="anonymous"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Akawa" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Akawa</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">ETY001的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-生活"><a href="/life" rel="section"><i class="fa fa-bicycle fa-fw"></i>生活</a></li><li class="menu-item menu-item-关于"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-dm实验室"><a href="/lab/" rel="section"><i class="fa fa-gear fa-fw"></i>DM实验室</a></li><li class="menu-item menu-item-捐助"><a href="/donate/" rel="section"><i class="fa fa-star fa-fw"></i>捐助</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-标签云"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签云</a></li><li class="menu-item menu-item-归档"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友链"><a href="/friendsblog/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ETY001"
      src="/img/logo.jpg">
  <p class="site-author-name" itemprop="name">ETY001</p>
  <div class="site-description" itemprop="description">ETY001的博客</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">482</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ety001" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ety001" rel="noopener me" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:work@akawa.ink" title="E-Mail → mailto:work@akawa.ink" rel="noopener me" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/ety001" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;ety001" rel="noopener me" target="_blank"><i class="weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/ety001" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;ety001" rel="noopener me" target="_blank"><i class="twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/04/25/fix-blank-page-when-proxy-kibana-through-nginx.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/25/fix-blank-page-when-proxy-kibana-through-nginx.html" class="post-title-link" itemprop="url">解决nginx反代kibana显示空白页的问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-26 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-26T00:00:00+08:00">2020-04-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>之前<a href="/2019/10/11/bitshares-es-node-add-kibana.html">搭建的 <strong>bitshares elastic search</strong></a> ，已经有太久不维护了，最近因为调整服务器的硬盘为 RAID0，这才发现有挺多问题了。其中一个问题就是，通过公网服务器的 <code>nginx</code> 进行反向代理的 <code>kibana</code> 面板一直是空白。</p>
<p>具体的现象就是，直接访问服务端口，一切正常，但是只要通过 <code>nginx</code> 进行反向代理，就是空白页。通过看浏览器，能看到已经把页面的 <code>HTML</code> 代码都下载回来了，但是不知道哪里解析不了。</p>
<p>最终发现是反向代理的配置有问题，贴出来已经测试通过的配置来记录下这次的问题吧：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_name **********;</span><br><span class="line">    ssl_certificate /etc/nginx/ssl/****.cer;</span><br><span class="line">    ssl_certificate_key /etc/nginx/ssl/****.key;</span><br><span class="line">    ssl_ciphers &quot;EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH&quot;;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    ssl_session_cache shared:SSL:10m;</span><br><span class="line">    location / &#123;</span><br><span class="line">        #proxy_redirect off;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">        proxy_set_header Connection &#x27;upgrade&#x27;;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_cache_bypass $http_upgrade;</span><br><span class="line">        proxy_pass http://172.20.0.1:5601;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="好用不贵的VPS"><a href="#好用不贵的VPS" class="headerlink" title="好用不贵的VPS"></a>好用不贵的VPS</h4><ul>
<li><a target="_blank" rel="noopener" href="https://my.racknerd.com/aff.php?aff=856&pid=207">1核1G内存18G硬盘1Gbps带宽1000GB流量&#x2F;月，洛杉矶机房，$23&#x2F;年</a></li>
<li><a target="_blank" rel="noopener" href="https://my.racknerd.com/aff.php?aff=856&pid=208">2核2G内存25G硬盘1Gbps带宽3000GB流量&#x2F;月，洛杉矶机房，$33&#x2F;年</a></li>
<li><a target="_blank" rel="noopener" href="https://kvm.yunserver.com/aff.php?aff=140&pid=79">1核1G内存20G硬盘30Mbps带宽600GB流量&#x2F;月，去程163直连 + 回程三网CN2_GIA，日本机房，年付方案优惠码：Friday_1，299元&#x2F;年</a> , 测速链接: <a target="_blank" rel="noopener" href="http://118.107.12.12/speedtest/">http://118.107.12.12/speedtest/</a></li>
<li><a target="_blank" rel="noopener" href="https://1hour.win/">xxxx 更多主机 xxxx</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/04/23/add-new-raid0-hard-disk-on-my-server.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/23/add-new-raid0-hard-disk-on-my-server.html" class="post-title-link" itemprop="url">今天把家里的服务器新配了Raid0硬盘</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-24 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-24T00:00:00+08:00">2020-04-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>鉴于现在家里的服务器，跑的服务太多了，尤其是近期跑起来 <code>hivemind</code> 和 <code>account history node</code>，明显感觉硬盘读写跟不上节奏了。</p>
<p>之前为了降低成本，买的硬盘都是希捷最便宜的硬盘。一块2T的和一块6TB的，加起来才 ￥1618。然后通过 LVM 把这两块硬盘做成了一个整体。</p>
<p>这次为了保证读写速度，也是多花了些钱，买了稍微上点档次的硬盘。西数的企业级硬盘，两块4TB的硬盘，加起来将近 ￥2000。</p>
<p>除了买的硬盘贵了些，还打算做成 <code>Raid0</code> 来提升读写速度。</p>
<p><code>RAID</code>，<code>Redundant Arrays of Independent Disks</code>，即磁盘阵列，有“独立磁盘构成的具有冗余能力的阵列”之意。</p>
<p>这是一个可以让你用廉价硬盘去实现更高可靠的存储介质的技术方案。<code>RAID</code> 有好几个等级，其中 <code>RAID0</code> 是几种等级里，对读写速度提升最大，但是数据安全最差的。具体的原理，请自行搜索。</p>
<p>这次我使用 <code>LVM</code> 来实现 <code>RAID0</code>，实现步骤：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># pvcreate /dev/sd&#123;d,e&#125;1</span><br><span class="line"># vgcreate raid0 /dev/sd&#123;d,e&#125;1</span><br><span class="line"># lvcreate -l +100%free -i 2 -I 128 raid0 -n raid0_lv</span><br><span class="line"># mkfs.ext4 /dev/raid0/raid0_lv</span><br><span class="line"># mount /dev/raid0/raid0_lv /data/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：<br>1.如果你的硬盘容量大于2TB，请先使用 <code>fdisk</code> 把硬盘分区表改为 <code>GPT</code><br>2.使用 <code>fdisk</code> 把磁盘的标记选择为 <code>Linux LVM</code>，然后再执行 <code>pvcreate</code><br>3.<code>lvcreate</code> 命令里 <code>-i</code> 设置驱动器数量，<code>-I</code> 设置 stripesize</p>
</blockquote>
<p>配置好以后，测试了下写入速度，真是快的飞起</p>
<p><img src="/upload/202004/4pd3RNz6xuTe35R2KeP6cR7NTfsPB5quJSpMUl2M.png"></p>
<p>接下来就是把 <code>hivemind</code> 那些数据转移到新的硬盘下，进行工作了！</p>
<hr>
<h4 id="好用不贵的VPS"><a href="#好用不贵的VPS" class="headerlink" title="好用不贵的VPS"></a>好用不贵的VPS</h4><ul>
<li><a target="_blank" rel="noopener" href="https://my.racknerd.com/aff.php?aff=856&pid=207">1核1G内存18G硬盘1Gbps带宽1000GB流量&#x2F;月，洛杉矶机房，$23&#x2F;年</a></li>
<li><a target="_blank" rel="noopener" href="https://my.racknerd.com/aff.php?aff=856&pid=208">2核2G内存25G硬盘1Gbps带宽3000GB流量&#x2F;月，洛杉矶机房，$33&#x2F;年</a></li>
<li><a target="_blank" rel="noopener" href="https://kvm.yunserver.com/aff.php?aff=140&pid=79">1核1G内存20G硬盘30Mbps带宽600GB流量&#x2F;月，去程163直连 + 回程三网CN2_GIA，日本机房，年付方案优惠码：Friday_1，299元&#x2F;年</a> , 测速链接: <a target="_blank" rel="noopener" href="http://118.107.12.12/speedtest/">http://118.107.12.12/speedtest/</a></li>
<li><a target="_blank" rel="noopener" href="https://1hour.win/">xxxx 更多主机 xxxx</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/04/19/back-to-job-new-trail.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/19/back-to-job-new-trail.html" class="post-title-link" itemprop="url">又从自由职业换回远程工作了</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-20 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-20T00:00:00+08:00">2020-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>《<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/WIW3QWunQF__9f4iIR8Ffw">今天正式离职了</a>》这是之前结束远程工作的时候，写的文章，距离现在过去了两年多了。现在我又重新回到了远程工作的状态。</p>
<p>自由职业和远程工作有什么不同？我觉得最大的不同就是，自由职业是为自己挣钱，远程工作是为别人打工。自由职业就像是创业，在没有准备好的时候去搞，很容易就吃了这顿没有下顿。而远程工作，更多的只是你的时间地点更灵活了，不受限制而已，工作关系和需要对谁负责的关系，跟传统坐班相比是没有变化的。</p>
<p>这次是借着孙宇晨收购Steemit的东风，加入到了 TRON （波场）的团队，来参与 Steem 公链相关的开发工作。</p>
<p>这应该算是我职业生涯里，第三次不是为了外包而活着了，也是我一直向往的工作体验。</p>
<p>能够一直打磨一件产品，让产品具有灵魂，让用户用的爽，是一件很有情怀的事情，因为这即实现了自我价值，又实现了社会价值。</p>
<p>我一直认为我是个有情怀的程序员，就像《中国合伙人2》里的楚振辉，即使生活如此不堪，但是内心还是有一个不灭的理想。</p>
<p>十年前我是如此，即使现在被生活快要磨平棱角，我觉得我依旧如此，否则我也不会选择过去两年的自由职业的生活。</p>
<p>如果把过去两年看作是我的第二次创业，最大的感受就是骑驴找马才是正确的打开方式。</p>
<p>在上次离职的时候，我只是看到了一个努力方向，就决定了离职去干。最终的现实就是，你在花完你的预算后，就需要一边打零工养家，一边去折腾你自己的事情，最后就是自己的事情顾不上了。</p>
<p>另外只是有个想法，没有市场数据支撑，就亦然去做，那么中途迷茫的概率就很大。就像我在《<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/WIW3QWunQF__9f4iIR8Ffw">今天正式离职了</a>》里写的上下半年的计划，其实最终没有一个实施好，都是因为做着做着发现了解决不了的问题，然后就半途而废了。</p>
<p>之后就会进入一个迷茫的时期，走不出来，接着就会一直很低落，时间会大把大把因为颓废而浪费。加上生活压力，整个人都是天天徘徊在崩溃边缘的。</p>
<p>所以骑驴找马，找到马后再遛一遛，确定是好马了，再决定要不要换坐骑。不过也有一个更重要的因素，可以推翻上面那个总结，那就是有钱。正所谓有钱不慌！</p>
<p>总之，新的工作开始了，又是一个新的起点了。</p>
<hr>
<h4 id="好用不贵的VPS"><a href="#好用不贵的VPS" class="headerlink" title="好用不贵的VPS"></a>好用不贵的VPS</h4><ul>
<li><a target="_blank" rel="noopener" href="https://my.racknerd.com/aff.php?aff=856&pid=207">1核1G内存18G硬盘1Gbps带宽1000GB流量&#x2F;月，洛杉矶机房，$23&#x2F;年</a></li>
<li><a target="_blank" rel="noopener" href="https://my.racknerd.com/aff.php?aff=856&pid=208">2核2G内存25G硬盘1Gbps带宽3000GB流量&#x2F;月，洛杉矶机房，$33&#x2F;年</a></li>
<li><a target="_blank" rel="noopener" href="https://kvm.yunserver.com/aff.php?aff=140&pid=79">1核1G内存20G硬盘30Mbps带宽600GB流量&#x2F;月，去程163直连 + 回程三网CN2_GIA，日本机房，年付方案优惠码：Friday_1，299元&#x2F;年</a> , 测速链接: <a target="_blank" rel="noopener" href="http://118.107.12.12/speedtest/">http://118.107.12.12/speedtest/</a></li>
<li><a target="_blank" rel="noopener" href="https://1hour.win/">xxxx 更多主机 xxxx</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/03/31/finally-build-handshake-service.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/31/finally-build-handshake-service.html" class="post-title-link" itemprop="url">终于部署成功 handshake 域名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-01 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-01T00:00:00+08:00">2020-04-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><code>handshake</code> 是一个基于区块链的分布式域名服务链。他的目标就是要把目前中心化的 ICANN 给取代掉。</p>
<p>由于 <code>handshake</code> 针对 <code>github</code> 的开发者进行了空投，我运气比较好的符合了空投规则，拿到了4000多个代币，于是我就有机会来体验一下整个拍卖和运行的过程。</p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>在目前阶段，我们是如何解析域名的呢？</p>
<p>假如我们有一个 <code>steem.61bts.com</code> 这样的域名，当我们访问这个域名的时候，系统会去DNS服务器获取 <code>61bts.com</code> 的 <code>NS</code> 记录，<code>NS</code>记录实际就是一台 <code>name server</code>，上面记录了 <code>61bts.com</code> 下面的所有域名与IP的对应关系。系统拿到 <code>NS</code> 记录后，访问 <code>name server</code>，就能拿到 <code>steem.61bts.com</code> 的真实 IP 地址了，然后就可以建立访问链接了。</p>
<p>那么有了 <code>handshake</code> 后是什么流程呢？</p>
<p>其实 <code>handshake</code> 做的工作就是把你的域名的 <code>NS</code> 记录存储在区块链上，这样人们访问 <code>steem.61bts.com</code> 的时候，会去区块链上找寻 <code>61bts.com</code> 的 <code>NS</code> 记录，然后再去访问 <code>name server</code>，最终拿到 IP 地址。</p>
<h1 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h1><p>目前 <code>handshake</code> 有一个面向用户友好的 <code>UI</code> 界面，即 <a target="_blank" rel="noopener" href="https://namebase.io/">https://namebase.io</a>。</p>
<p><code>Namebase</code> 的作用就是给用户提供一个方便拍卖，方便配置的 UI 界面。尤其是最近 <code>Namebase</code> 在配置面板上增加了他们自己维护的 <code>name server</code>（下面就简称 <code>NS</code> 了），更加方便用户去配置了。</p>
<p>这次的教程就是基于 <code>Namebase</code> 提供的 <code>NS</code> 服务器来搞的。</p>
<h2 id="配置-NS-记录上链"><a href="#配置-NS-记录上链" class="headerlink" title="配置 NS 记录上链"></a>配置 NS 记录上链</h2><p>访问 <a target="_blank" rel="noopener" href="https://www.namebase.io/domain-manager">https://www.namebase.io/domain-manager</a> ，选择你要配置的域名，点击后面的 <strong>Edit DNS</strong>。</p>
<p>在新的页面上，你可以看到分为上下两部分。</p>
<p><img src="/upload/202004/handshake.png"></p>
<p>上半部分是配置域名的 <code>NS</code> 记录，下半部分是配置域名的解析地址（也就是 <code>Namebase</code> 官方提供给我们的 <code>NS</code> 的配置面板）。</p>
<p>在目前的中心化网络里，我们在域名商处买了域名，常见到的就是下半部分的配置面板。</p>
<p>在此之前，我们需要运行一台自己的 <code>NS</code> 服务器，但是现在，我们只需要把 <code>Namebase</code> 官方提供的 <code>NS</code> 的 IP 地址 <code>44.231.6.183</code> 添加进去即可。</p>
<p>具体操作方法就是在上半部分，增加一条 <code>NS</code> 记录，其中 <code>Name</code> 栏填写 <code>ns1</code>，<code>Value/Data</code> 栏填写 <code>44.231.6.183</code>，然后，在页面最下面，点击保存。</p>
<p>由于这个记录需要上链，所以需要等一段时间，等自己的记录成功打包进块，就完成了这部分的配置。也就是大家可以通过区块链查到你的域名指向了哪个 <code>NS</code> 服务器。</p>
<p>之后，你可以在下半部分，配置域名的 <code>A</code> 记录之类的了。</p>
<h2 id="配置-handshake-全节点"><a href="#配置-handshake-全节点" class="headerlink" title="配置 handshake 全节点"></a>配置 handshake 全节点</h2><p>那么在这个等待的时间，我们需要去搭建一个 <code>handshake</code> 的全节点。全节点的作用就是把整个区块链的数据下载下来，然后提供 <code>DNS</code> 服务，供你查询链上的域名 <code>NS</code> 记录。</p>
<p>我个人比较喜欢使用 <code>Docker</code>，所以这里的部署方案也是 <code>Docker</code> 部署。</p>
<p>目前，我已经编译好了一个 <code>Docker</code> 镜像，大家可以直接使用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull ety001/hsd:latest</span><br></pre></td></tr></table></figure>

<blockquote>
<p>你当然也可以自己去编译，源码库在这里： <a target="_blank" rel="noopener" href="https://github.com/handshake-org/hsd">https://github.com/handshake-org/hsd</a> 。</p>
</blockquote>
<p>拉取完镜像后，创建一个目录用来存放区块数据，假设目录名为 <code>/data</code></p>
<p>如果你想用宿主机网络运行容器，则执行下面的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd \</span><br><span class="line">    --name hsd \</span><br><span class="line">    --restart always \</span><br><span class="line">    -v /data:/root/.hsd \</span><br><span class="line">    ety001/hsd:latest \</span><br><span class="line">    hsd --rs-host 0.0.0.0 --rs-port 53 --rs-no-unbound true</span><br></pre></td></tr></table></figure>

<p>如果你想用 <code>Docker</code> 独立的内部网络，则执行下面的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd \</span><br><span class="line">    --name hsd \</span><br><span class="line">    --restart always \</span><br><span class="line">    -v /data:/root/.hsd \</span><br><span class="line">    -p 53:53 \</span><br><span class="line">    -p 53:53/udp \</span><br><span class="line">    ety001/hsd:latest \</span><br><span class="line">    hsd --rs-host 0.0.0.0 --rs-port 53 --rs-no-unbound true</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：请先查看你的 53 端口是否有其他程序占用</p>
</blockquote>
<p>这样，一个全节点就在你的本地启动了。你可以使用下面的命令来查看 <code>Log</code> 信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f --tail 100 hsd</span><br></pre></td></tr></table></figure>

<p>等到所有区块同步完成，你就可以测试下你的全节点是否可以正确检索到你的域名的 <code>NS</code> 记录了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig @localhost 你的handshake域名</span><br></pre></td></tr></table></figure>

<p>如果一切顺利，你就可以看到你刚才配置的域名 <code>A</code> 记录了。</p>
<h1 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h1><p>上面的操作，如果一切顺利的话，这个时候，你就可以把你网络中的首选DNS换成你运行全节点的机器的IP了。</p>
<p>我是在我家里的磁盘阵列上搭建的全节点，然后在路由器上，把首选 <code>DNS</code> 设置为了磁盘阵列的机器的 IP，这样我家里的所有设备就都可以访问 <code>handshake</code> 的域名了。</p>
<p>另外，我还在公网上搭建了一个全节点用于解析，<code>172.81.246.231</code>，欢迎体验。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/03/25/steem-fullnode-build.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/25/steem-fullnode-build.html" class="post-title-link" itemprop="url">Steem Fullnode 部署大致步骤</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-26 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-26T00:00:00+08:00">2020-03-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这篇讲述了如何部署 steemd 的 fullnode 版本。部署好以后，可以提供大部分 API 使用，但是无法直接用于 steemit 的 UI（即 <a target="_blank" rel="noopener" href="https://github.com/steemit/condenser">https://github.com/steemit/condenser</a>）。</p>
<blockquote>
<p>注意：由于该方案使用 Docker 部署，所以请先自行安装 Docker。<br>注意：<strong>该方案是部署 0.22.5 mira 版本</strong></p>
</blockquote>
<h1 id="下面是步骤："><a href="#下面是步骤：" class="headerlink" title="下面是步骤："></a>下面是步骤：</h1><h2 id="（一）克隆控制脚本"><a href="#（一）克隆控制脚本" class="headerlink" title="（一）克隆控制脚本"></a>（一）克隆控制脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Someguy123/steem-docker.git</span><br></pre></td></tr></table></figure>

<h2 id="（二）进入目录"><a href="#（二）进入目录" class="headerlink" title="（二）进入目录"></a>（二）进入目录</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd steem-docker/</span><br></pre></td></tr></table></figure>

<h2 id="（三）如果你还没有装-Docker-可以执行下面的命令"><a href="#（三）如果你还没有装-Docker-可以执行下面的命令" class="headerlink" title="（三）如果你还没有装 Docker 可以执行下面的命令"></a>（三）如果你还没有装 Docker 可以执行下面的命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./run.sh install_docker</span><br></pre></td></tr></table></figure>

<h2 id="（四）下载-block-log"><a href="#（四）下载-block-log" class="headerlink" title="（四）下载 block_log"></a>（四）下载 block_log</h2><p>如果你不想从0开始同步，可以选择下载已有区块数据。<br>由于 @someguy123 目前提供的数据可能是 hive 的，最<br>好不要用 run.sh 脚本内的下载指令。目前我提供了一份<br>镜像下载。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 进入存放目录</span><br><span class="line">cd data/witness_node_data_dir/blockchain/</span><br><span class="line"># 下载</span><br><span class="line">wget -c http://da.mypi.win/block_log</span><br></pre></td></tr></table></figure>

<blockquote>
<p>建议：把下载放在 screen 中执行，下载结束后，返回 steem-docker&#x2F; 目录</p>
</blockquote>
<h2 id="（五）修改配置文件"><a href="#（五）修改配置文件" class="headerlink" title="（五）修改配置文件"></a>（五）修改配置文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim data/witness_node_data_dir/config.ini</span><br></pre></td></tr></table></figure>

<h3 id="需要着重修改的是"><a href="#需要着重修改的是" class="headerlink" title="需要着重修改的是"></a>需要着重修改的是</h3><ul>
<li><p>(1) 把 p2p 节点注释掉，可以使用默认p2p节点，也可以参考这里 <a target="_blank" rel="noopener" href="https://steemit.com/cn/@ety001/steem-seed">https:&#x2F;&#x2F;steemit.com&#x2F;cn&#x2F;@ety001&#x2F;steem-seed</a></p>
</li>
<li><p>(2) 注释掉 <strong>shared-file-dir</strong>，也就是不使用 <strong>&#x2F;dev&#x2F;shm</strong> ，这可以剩下不少内存</p>
</li>
<li><p>(3) 打开下面的两个配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">webserver-http-endpoint = 0.0.0.0:8090</span><br><span class="line">webserver-ws-endpoint = 0.0.0.0:8091</span><br></pre></td></tr></table></figure>
</li>
<li><p>(4) 增加plugin，其中没有 follow 插件，该插件可能有些问题，建议直接上 hivemind。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plugin = webserver p2p json_rpc witness account_by_key reputation market_history</span><br><span class="line">plugin = database_api account_by_key_api network_broadcast_api reputation_api market_history_api condenser_api block_api rc_api</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="（六）下载镜像"><a href="#（六）下载镜像" class="headerlink" title="（六）下载镜像"></a>（六）下载镜像</h2><p>由于 @someguy123 没有提供打包好的 0.22.5 mira 版镜像，<br>所以你需要用 <code>dkr_fullnode</code> 目录下的 <code>Dockerfile</code> 自己编译。</p>
<p>或者直接使用我编译好的，该教程则以我的镜像为例。</p>
<ul>
<li>(1) 先拉取镜像<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull ety001/steem-full-mira:0.22.5</span><br></pre></td></tr></table></figure></li>
<li>(2) 镜像重命名。<code>run.sh</code> 使用的镜像名须为 <code>steem</code>。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag ety001/steem-full-mira:0.22.5 steem</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="（七）修改-run-sh"><a href="#（七）修改-run-sh" class="headerlink" title="（七）修改 run.sh"></a>（七）修改 run.sh</h2><p>由于默认是只映射了 2001 端口出来，所以还需要修改 <code>run.sh</code>。<br>打开文件，找到头部 <code>PORTS</code> 设置，参照下面的方式修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">: $&#123;PORTS=&quot;2001,8090,8091&quot;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>上面的例子就是映射容器的 2001，8090，8091三个端口</p>
</blockquote>
<h2 id="（八）开始replay"><a href="#（八）开始replay" class="headerlink" title="（八）开始replay"></a>（八）开始replay</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./run.sh replay</span><br></pre></td></tr></table></figure>

<h2 id="（九）-replay-结束后"><a href="#（九）-replay-结束后" class="headerlink" title="（九） replay 结束后"></a>（九） replay 结束后</h2><p>replay结束后，可以选择不管，也可以 <code>./run.sh stop &amp;&amp; ./run.sh start</code> 重新启动。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>以上就是大致的部署 0.22.5 mira 版的步骤。真正的全节点还需要部署 jussi 和 hivemind。</p>
<p>jussi 相当于是接口层，后面跟着 steemd 和 hivemind 提供数据。</p>
<p>目前还没有研究 hivemind 的搭建。</p>
<hr>
<h4 id="PS-便宜的独立服务器推荐"><a href="#PS-便宜的独立服务器推荐" class="headerlink" title="PS: 便宜的独立服务器推荐"></a>PS: <a target="_blank" rel="noopener" href="https://billing.dacentec.com/hostbill/?affid=723">便宜的独立服务器推荐</a></h4>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/03/25/steem-hivemind-build.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/25/steem-hivemind-build.html" class="post-title-link" itemprop="url">Steem Hivemind 搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-26 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-26T00:00:00+08:00">2020-03-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><a target="_blank" rel="noopener" href="https://github.com/steemit/hivemind">hivemind</a> 其实就是为了解决 <code>steemd</code> 的 <code>API</code> 压力过大而设计的数据库，主要是把文章数据，关注数据等等一系列细碎但是访问频度高的数据整理出来。</p>
<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><ul>
<li>docker-compose</li>
</ul>
<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><h2 id="1-新建目录"><a href="#1-新建目录" class="headerlink" title="1) 新建目录"></a>1) 新建目录</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir hivemind</span><br></pre></td></tr></table></figure>
<p>接下来的东西都将放在这个目录里面。</p>
<h2 id="2-新建-docker-compose-yml"><a href="#2-新建-docker-compose-yml" class="headerlink" title="2) 新建 docker-compose.yml"></a>2) 新建 <code>docker-compose.yml</code></h2><p>在 <code>hivemind/</code> 目录下创建 <code>docker-compose.yml</code> 文件，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3&#x27;</span><br><span class="line">services:</span><br><span class="line">  db:</span><br><span class="line">    image: postgres</span><br><span class="line">    environment:</span><br><span class="line">      POSTGRES_USER: steem</span><br><span class="line">      POSTGRES_PASSWORD: steem</span><br><span class="line">      POSTGRES_DB: hivedb</span><br><span class="line">    volumes:</span><br><span class="line">      - ./data:/var/lib/postgresql/data</span><br><span class="line">    restart: always</span><br><span class="line">  hive:</span><br><span class="line">    depends_on:</span><br><span class="line">      - db</span><br><span class="line">    image: ety001/hivemind</span><br><span class="line">    environment:</span><br><span class="line">      DATABASE_URL: postgresql://steem:steem@db:5432/hivedb</span><br><span class="line">      LOG_LEVEL: INFO</span><br><span class="line">      STEEMD_URL: http://172.20.0.10:8091</span><br><span class="line">      SYNC_SERVICE: 1</span><br><span class="line">    ports:</span><br><span class="line">      - 8888:8080</span><br><span class="line">    links:</span><br><span class="line">      - db:db</span><br><span class="line">    restart: always</span><br></pre></td></tr></table></figure>

<p>这里注意，需要修改 <code>STEEMD_URL</code> 为你的 <code>steemd</code> 的 <code>webserver</code> 地址。<br>另外，检查 <code>8888</code> 端口是否占用，如果已被占用，换之。</p>
<h2 id="3-启动"><a href="#3-启动" class="headerlink" title="3) 启动"></a>3) 启动</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<p>可以通过下面的命令查看容器名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure>

<p>假设容器名是 <code>hivemind_hive_1</code>，可以通过下面的命令查看Log</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f --tail 1000 hivemind_hive_1</span><br></pre></td></tr></table></figure>

<p>可以通过下面的命令查看同步进度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it hivemind_hive_1 hive status</span><br></pre></td></tr></table></figure>

<p><img src="/upload/202003/hivemind.png"></p>
<h2 id="4-配置-jussi"><a href="#4-配置-jussi" class="headerlink" title="4) 配置 jussi"></a>4) 配置 <code>jussi</code></h2><p>如果是按照之前的教程 <a target="_blank" rel="noopener" href="https://steemit.com/cn/@ety001/jussi">https:&#x2F;&#x2F;steemit.com&#x2F;cn&#x2F;@ety001&#x2F;jussi</a> 搭建的，切换到 <code>jussi</code> 目录下，下载针对 <code>hivemind</code> 的配置文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -c https://raw.githubusercontent.com/steemit/jussi/master/EXAMPLE_hivemind_upstream_config.json</span><br></pre></td></tr></table></figure>

<p>改一下名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv  EXAMPLE_hivemind_upstream_config.json  hive_config.json</span><br></pre></td></tr></table></figure>

<p>打开这个配置文件，把里面所有标有 <code>steemd</code> 的 <code>URL</code> 换成你的 <code>steemd</code> 地址，所有标有 <code>hivemind</code> 的 <code>URL</code> 换成你的 <code>hivemind</code> 的地址。</p>
<p>例如，你宿主机IP是 <code>1.1.1.1</code>， <code>steemd</code> 是 <code>http://1.1.1.1:8091</code>，<code>hivemind</code> 是 <code>http://1.1.1.1:8888</code>，那么把 <code>https://your.account.history.steemd.url</code> 换成 <code>http://1.1.1.1:8091</code>，把 <code>https://your.hivemind.url</code> 换成 <code>http://1.1.1.1:8888</code>。</p>
<p>修改好以后，再打开 <code>jussi</code> 的 <code>docker-compose.yml</code>，把其中的配置文件映射修改为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volumes:</span><br><span class="line">      - ./hive_config.json:/app/config.json</span><br></pre></td></tr></table></figure>

<p>保存后，重启 <code>jussi</code> 完成配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down &amp;&amp; docker-compose up -d</span><br></pre></td></tr></table></figure>

<p>剩下的就等 <code>hivemind</code> 完成同步。</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="1-关于编译"><a href="#1-关于编译" class="headerlink" title="1) 关于编译"></a>1) 关于编译</h2><p>本例中使用了我编译好的 <code>hivemind</code> 镜像，你可以选择自己编译，步骤是：</p>
<p>先下载代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/steemit/hivemind.git</span><br></pre></td></tr></table></figure>

<p>编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd hivemind</span><br><span class="line">docker build -t hivemind .</span><br></pre></td></tr></table></figure>

<h2 id="2-关于-PostgreSQL-优化"><a href="#2-关于-PostgreSQL-优化" class="headerlink" title="2) 关于 PostgreSQL 优化"></a>2) 关于 <code>PostgreSQL</code> 优化</h2><p>如果你想优化 <code>PostgreSQL</code>，可以参考下面的步骤：</p>
<p>先进入到 <code>hivemind/</code> 目录下，然后导出容器里的默认配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -i --rm postgres cat /usr/share/postgresql/postgresql.conf.sample &gt; my-postgres.conf</span><br></pre></td></tr></table></figure>

<p>把你想修改的参数在 <code>my-postgres.conf</code> 中修改好。官方给了一份 16G 内存 SSD 硬盘的优化方案作为参考：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">effective_cache_size = 12GB # 50-75% of avail memory</span><br><span class="line">maintenance_work_mem = 2GB</span><br><span class="line">random_page_cost = 1.0      # assuming SSD storage</span><br><span class="line">shared_buffers = 4GB        # 25% of memory</span><br><span class="line">work_mem = 512MB</span><br><span class="line">synchronous_commit = off</span><br><span class="line">checkpoint_completion_target = 0.9</span><br><span class="line">checkpoint_timeout = 30min</span><br><span class="line">max_wal_size = 4GB</span><br></pre></td></tr></table></figure>

<p>修改好以后，打开 <code>docker-compose.yml</code> 文件，增加配置文件映射，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">volumes:</span><br><span class="line">      - ./data:/var/lib/postgresql/data</span><br><span class="line">      - ./my-postgres.conf:/etc/postgresql/postgresql.conf</span><br></pre></td></tr></table></figure>

<p>最后一行就是我们新增的配置。</p>
<p>保存后，重启</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down &amp;&amp; docker-compose up -d</span><br></pre></td></tr></table></figure>

<h2 id="3-关于容器端口映射"><a href="#3-关于容器端口映射" class="headerlink" title="3) 关于容器端口映射"></a>3) 关于容器端口映射</h2><p>由于 <code>docker</code> 的默认策略优先级在 <code>iptables</code> 中比 <code>ufw</code> 和 <code>firewalld</code> 高，所以所有把容器端口映射出来的操作，端口在公网是可被访问的。</p>
<p>由于我的 <code>nginx</code> 是通过容器运行的，所以我没有对端口映射，而是直接把相关容器额外加入到 <code>nginx</code> 容器所在网络下，并指定好固定IP，这样各个容器直接可以互访。</p>
<hr>
<h4 id="PS-便宜的独立服务器推荐"><a href="#PS-便宜的独立服务器推荐" class="headerlink" title="PS: 便宜的独立服务器推荐"></a>PS: <a target="_blank" rel="noopener" href="https://billing.dacentec.com/hostbill/?affid=723">便宜的独立服务器推荐</a></h4>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/03/25/steem-jussi-build.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/25/steem-jussi-build.html" class="post-title-link" itemprop="url">Steem Jussi 搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-26 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-26T00:00:00+08:00">2020-03-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><a target="_blank" rel="noopener" href="https://github.com/steemit/jussi">jussi</a> 是全节点的最前端的缓存层，负责用 JSON 把后端数据源数据格式统一，且提供缓存功能，提高吞吐量。</p>
<p>这篇帖子就来简单说下如何搭建。</p>
<blockquote>
<p>注意：需要提前安装 <code>docker-compose</code></p>
</blockquote>
<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><h2 id="1-创建目录"><a href="#1-创建目录" class="headerlink" title="1. 创建目录"></a>1. 创建目录</h2><p>新建一个目录，用于存储与 <code>jussi</code> 相关的东西</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir jussi</span><br></pre></td></tr></table></figure>

<h2 id="2-创建配置文件"><a href="#2-创建配置文件" class="headerlink" title="2. 创建配置文件"></a>2. 创建配置文件</h2><p>在 <code>jussi/</code> 目录下，新建 <code>config.json</code> 文件，内容如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;limits&quot;: &#123;</span><br><span class="line">    &quot;blacklist_accounts&quot;: [</span><br><span class="line">      &quot;non-steemit&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;upstreams&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;steemd&quot;,</span><br><span class="line">      &quot;translate_to_appbase&quot;: true,</span><br><span class="line">      &quot;urls&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd&quot;,</span><br><span class="line">         &quot;http://172.20.0.10:8091&quot;</span><br><span class="line">        ]</span><br><span class="line">      ],</span><br><span class="line">      &quot;ttls&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd&quot;,</span><br><span class="line">          3</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.login_api&quot;,</span><br><span class="line">          -1</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.network_broadcast_api&quot;,</span><br><span class="line">          -1</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.follow_api&quot;,</span><br><span class="line">          10</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.market_history_api&quot;,</span><br><span class="line">          1</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api&quot;,</span><br><span class="line">          3</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_block&quot;,</span><br><span class="line">          -2</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_block_header&quot;,</span><br><span class="line">          -2</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_content&quot;,</span><br><span class="line">          1</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_state&quot;,</span><br><span class="line">          1</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_state.params=[&#x27;/trending&#x27;]&quot;,</span><br><span class="line">          30</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_state.params=[&#x27;trending&#x27;]&quot;,</span><br><span class="line">          30</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_state.params=[&#x27;/hot&#x27;]&quot;,</span><br><span class="line">          30</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_state.params=[&#x27;/welcome&#x27;]&quot;,</span><br><span class="line">          30</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_state.params=[&#x27;/promoted&#x27;]&quot;,</span><br><span class="line">          30</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_state.params=[&#x27;/created&#x27;]&quot;,</span><br><span class="line">          10</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.database_api.get_dynamic_global_properties&quot;,</span><br><span class="line">          1</span><br><span class="line">        ]</span><br><span class="line">      ],</span><br><span class="line">      &quot;timeouts&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd&quot;,</span><br><span class="line">          5</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;steemd.network_broadcast_api&quot;,</span><br><span class="line">          0</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;appbase&quot;,</span><br><span class="line">      &quot;urls&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase&quot;,</span><br><span class="line">          &quot;http://172.20.0.10:8091&quot;</span><br><span class="line">        ]</span><br><span class="line">      ],</span><br><span class="line">      &quot;ttls&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase&quot;,</span><br><span class="line">          -2</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.block_api&quot;,</span><br><span class="line">          -2</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.database_api&quot;,</span><br><span class="line">          1</span><br><span class="line">        ]</span><br><span class="line">      ],</span><br><span class="line">      &quot;timeouts&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase&quot;,</span><br><span class="line">          3</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.chain_api.push_block&quot;,</span><br><span class="line">          0</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.chain_api.push_transaction&quot;,</span><br><span class="line">          0</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.network_broadcast_api&quot;,</span><br><span class="line">          0</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.condenser_api.broadcast_block&quot;,</span><br><span class="line">          0</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.condenser_api.broadcast_transaction&quot;,</span><br><span class="line">          0</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.condenser_api.broadcast_transaction_synchronous&quot;,</span><br><span class="line">          0</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &quot;appbase.condenser_api.get_ops_in_block.params=[2889020,false]&quot;,</span><br><span class="line">          20</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>搜索 <code>http://172.20.0.10:8091</code> ，把里面出现两次的地方，都换成你自己的 <code>steemd</code> 的地址和端口。</p>
<blockquote>
<p>注意：填写的IP是否可以在容器内被访问。比如你宿主机IP是1.1.1.1，你用1.1.1.1:8091可以访问 <code>steemd</code> ，那么在配置文件里就这样填写即可。</p>
</blockquote>
<h2 id="3-创建-docker-compose-yml"><a href="#3-创建-docker-compose-yml" class="headerlink" title="3. 创建 docker-compose.yml"></a>3. 创建 <code>docker-compose.yml</code></h2><p>在 <code>jussi/</code> 目录下创建 <code>docker-compose.yml</code>，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;3.3&quot;</span><br><span class="line">services:</span><br><span class="line">  jussi:</span><br><span class="line">    restart: &quot;always&quot;</span><br><span class="line">    image: &quot;steemit/jussi:latest&quot;</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;8080:8080&quot;</span><br><span class="line">    environment:</span><br><span class="line">      JUSSI_UPSTREAM_CONFIG_FILE: /app/config.json</span><br><span class="line">      JUSSI_REDIS_URL: redis://redis1:6379</span><br><span class="line">    volumes:</span><br><span class="line">      - ./config.json:/app/config.json</span><br><span class="line">  redis1:</span><br><span class="line">    restart: &quot;always&quot;</span><br><span class="line">    image: &quot;redis:latest&quot;</span><br><span class="line">    volumes:</span><br><span class="line">      - ./redis1:/data</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意： 确认下你目前机器是否有程序占用 <code>8080</code> 端口，如果有占用，修改一下 <code>ports</code> 参数中冒号前面的端口号</p>
</blockquote>
<h2 id="4-启动"><a href="#4-启动" class="headerlink" title="4. 启动"></a>4. 启动</h2><p>进入 <code>jussi/</code> 目录后，执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<p>即可启动。启动后，<code>8080</code> 端口即为 <code>jussi</code> 的服务端口。配合 <code>nginx</code> 进行反向代理，加上证书即可。</p>
<h1 id="其他参考命令"><a href="#其他参考命令" class="headerlink" title="其他参考命令"></a>其他参考命令</h1><p>以下命令需要在 <code>jussi/</code> 目录下执行</p>
<h2 id="1-停止并卸载容器和网络"><a href="#1-停止并卸载容器和网络" class="headerlink" title="1. 停止并卸载容器和网络"></a>1. 停止并卸载容器和网络</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down</span><br></pre></td></tr></table></figure>

<h2 id="2-查看相关运行容器"><a href="#2-查看相关运行容器" class="headerlink" title="2. 查看相关运行容器"></a>2. 查看相关运行容器</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure>

<h2 id="3-查看log"><a href="#3-查看log" class="headerlink" title="3. 查看log"></a>3. 查看log</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看log，并且截取最后100行，且持续输出。容器名不填就是全部容器</span><br><span class="line">docker-compose logs -f --tail 100 [容器名]</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://github.com/steemit/jussi">https://github.com/steemit/jussi</a></p>
<hr>
<h4 id="PS-便宜的独立服务器推荐"><a href="#PS-便宜的独立服务器推荐" class="headerlink" title="PS: 便宜的独立服务器推荐"></a>PS: <a target="_blank" rel="noopener" href="https://billing.dacentec.com/hostbill/?affid=723">便宜的独立服务器推荐</a></h4>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/03/22/the-first-steem-full-node-on-china-mainland.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/22/the-first-steem-full-node-on-china-mainland.html" class="post-title-link" itemprop="url">中国大陆地区第一台不稳定Steem全节点正式上线</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-23 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-23T00:00:00+08:00">2020-03-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>鉴于之前全节点的内存占用太高（需要256G内存），一直没有机会去部署一台。后来Mira版出来后，社区也没有看到有相关的运行信息的帖子，而我也是懒，所以这个事情就一直拖到现在。</p>
<p>最近由于 Tron 收购 Steem 的事件发酵过程中，曾有一段时间多数节点不可用，于是我又重新把这个事情提上了议事日程。</p>
<p>经过两周的折腾，目前服务器已上线，地址是：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://steem.61bts.com/">https://steem.61bts.com</a></p>
</blockquote>
<h1 id="相关信息"><a href="#相关信息" class="headerlink" title="相关信息"></a>相关信息</h1><p>下面就来总结下，以给想要搭建全节点的同学参考。</p>
<h2 id="软件实施方案"><a href="#软件实施方案" class="headerlink" title="软件实施方案"></a>软件实施方案</h2><p>目前我是使用 @someguy123 的 Docker 工具来部署的，整个部署过程还是很轻松的。其中需要注意的就是 <code>config.ini</code> 的配置中的 <code>plugin</code> 配置，可以参考官方的配置文件。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/steemit/steem/blob/master/contrib/fullnode.config.ini">https://github.com/steemit/steem/blob/master/contrib/fullnode.config.ini</a><br>官方配置中缺少了 <code>follow</code> 插件</p>
</blockquote>
<p>另外就是 <code>Shared file</code> 的配置，如果要省内存，就不要把 <code>Shared file</code> 放到 <code>/dev/shm</code> 里，我的配置信息可以参考下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shared-file-size = 64G</span><br><span class="line">shared-file-dir = /steem/witness_node_data_dir/blockchain/</span><br></pre></td></tr></table></figure>

<p>记得把 <code>web</code> 服务端口打开</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">webserver-http-endpoint = 0.0.0.0:8091</span><br><span class="line">webserver-ws-endpoint = 0.0.0.0:8090</span><br></pre></td></tr></table></figure>

<p>同时还要在 <code>run.sh</code> 中打开端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">: $&#123;PORTS=&quot;2001,8090,8091&quot;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="硬件参考"><a href="#硬件参考" class="headerlink" title="硬件参考"></a>硬件参考</h2><p>目前我的服务器配置如下：</p>
<ul>
<li>双路 E5 2670</li>
<li>256G 内存</li>
<li>硬盘是 一块希捷 6T 硬盘（ST6000NM0115）和一块希捷 2T 硬盘（ST2000DM006）组成的 8T 大小的 LVM 卷</li>
</ul>
<h2 id="网络情况"><a href="#网络情况" class="headerlink" title="网络情况"></a>网络情况</h2><p>由于在国内主机服务商买大内存+高带宽的设备太特么几吧贵了，所以我用了一个折中的办法，这也是为什么我说是不稳定全节点的原因。</p>
<p>折中方案就是，机器自己组装放在家里，网络出口从机房买。</p>
<p>目前家里是联通光纤，上行是 30Mbps，然后在阿里云买了一台 1核 1G内存 5Mbps 青岛节点的 ECS（我家离青岛节点近，延时 10ms 以内），最后使用 <a target="_blank" rel="noopener" href="https://github.com/ehang-io/nps">NPS&#x2F;NPC</a> 把家里的服务器端口映射到阿里云的 ECS上。</p>
<p>之所以使用 NPS 也是积累的经验。</p>
<p>最早的时候，我是家里用 DDNS 把动态公网 IP 绑定在一个域名A上，然后在 ECS 上，用 Nginx 反向代理到域名A。</p>
<p>这个方案的缺点就是，如果动态 IP 变了，那么你的 ECS 上的 Nginx 也需要重启才能刷新域名A到 IP 的 DNS 缓存。</p>
<p>而 NPS 是服务端&#x2F;客户端程序。客户端跑在家里的服务器上，服务端跑在 ECS 上。这样就是客户端主动去连接服务端，并建立隧道。这就避免了动态 IP 变动的尴尬。</p>
<p>目前服务最大的不稳定性，就是由于服务器在家里，意外断电的情况还是存在的。</p>
<h2 id="运行参考"><a href="#运行参考" class="headerlink" title="运行参考"></a>运行参考</h2><p>目前全节点运行后，内存占用情况是，<strong>真实内存占用不到 3G ，虚拟内存占用不到 14G</strong>。</p>
<p>区块数据的硬盘占用，在当前高度（41626529），<code>witness_node_data_dir/blockchain</code> <strong>目录的大小是 362G</strong>。</p>
<p>这次我先后尝试了带 <code>--memory-replay</code> 参数和不带参数的 <code>replay</code>。带着 <code>--memory-replay</code> 参数，目前的区块高度进行 <code>replay</code> 的话，需要 230G 内存。而不带参数，则只需要不到 3G 内存。</p>
<p>所以，内存足够的话，可以尝试用 <code>--memory-replay</code> 参数加速 <code>replay</code> 过程，等 <code>replay</code> 结束后，可以停掉进程后，去掉参数再启动，就可以了。</p>
<p>目前高度的数据，不使用 <code>--memory-replay</code> 参数，在机械硬盘的情况下，<code>replay</code> 一次大概需要6天多的时间。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>MIra版的确是最大程度把数据从内存里摘出来了，这对于社交平台服务端来说太重要了。因为社交平台的数据是爆炸性增长的，如果都怼到内存里，服务端的运行成本就太高了！</p>
<p>不过目前的架构设计还是没有完全解决后期数据量暴涨可能导致的成本问题、维护问题。</p>
<p>如果有什么问题，可以直接回复本帖。</p>
<p>完！撒花！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/03/19/fix-cloudflare-cdn-301-issue.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/19/fix-cloudflare-cdn-301-issue.html" class="post-title-link" itemprop="url">解决CDN缓存301的问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-20 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-20T00:00:00+08:00">2020-03-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>今天在部署新的节点的时候，遇到了一个奇怪的事情，就是配置完 Nginx 后，访问 443 端口出现莫名其妙的 301 循环。</p>
<p>我的 Nginx 的配置文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name s2.61bts.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        return 301 https://s2.61bts.com$request_uri;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_name s2.61bts.com;</span><br><span class="line">    ssl_certificate /etc/nginx/ssl/s2.61bts.com.fullchain.cer;</span><br><span class="line">    ssl_certificate_key /etc/nginx/ssl/s2.61bts.com.key;</span><br><span class="line">    ssl_ciphers &quot;EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH&quot;;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    ssl_session_cache shared:SSL:10m;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_pass http://172.20.0.21:8080;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>正常情况下，访问 80 端口会 301 到 443 端口去，然后就正常访问了。</p>
<p>但是这次，却出现了 301 循环。</p>
<p>检查了 Nginx 配置，防火墙等等各个地方，就是没有查出原因来。</p>
<p>在命令行下用 curl 访问 443 端口显示的是 301 跳转的内容，总感觉哪个地方有缓存一样。</p>
<p>郁闷了小半天，突然想起来了我还有CDN没有检查。由于这个服务器是在国外，为了提升国内访问速度，所以我配置了CDN。</p>
<p>我登陆域名管理面板，把CDN先关掉，再访问一切正常！！还真是CDN的问题。</p>
<p>但是是哪里的配置导致的缓存呢？</p>
<p>最终发现原来是回源的问题。</p>
<p><img src="/upload/202003/2gsjgna1uruvUuS7ndgyCHjMdwbmktNvgzSa547pgFWFJLZKjAD3p9cNJFT1hhCFZFRxW8gNuejRvqKX5fMeP1dfh59wsRPWRKuRvAMjrQHLi6wZSW.png"></p>
<p>Cloudflare 默认的 SSL 策略是 Flexible，也就是回源的时候不使用 SSL&#x2F;TLS 加密，而是直接访问 80 端口。然后CDN一般都会直接缓存 301 页面，这就导致访问 443 的时候其实是访问的缓存，进而产生循环。</p>
<p>既然找到了原因那就好办了，只需要设置为 Full 模式，强制回源的时候走 443 端口就可以了。</p>
<p>设置好以后，重新打开CDN，清掉所有缓存，再访问，一切正常！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2020/03/11/code-server-trick.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/11/code-server-trick.html" class="post-title-link" itemprop="url">Code Server使用小技巧--禁用浏览器标签页关闭</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-12 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-12T00:00:00+08:00">2020-03-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近在我工作用的台式机上部署了传说中的、微软的 <strong>Code Server</strong>。</p>
<p><strong>Code Server</strong> 其实就是微软 <strong>Code editing</strong> 的服务器版，可以通过在你的服务器上，通过 <strong>Docker</strong> 容器建立一个网页 <strong>IDE</strong>，这样能做的事情就太多了。</p>
<p>比如我现在需要经常出门，而我的工作环境都在台式机上，有时候出门仅几个小时，在笔记本上可能代码都没有写完，就回家了，要把工作进度转移到台式机上就很麻烦。</p>
<p>现在用了 <strong>Code Server</strong> 后，我出门在笔记本上，只要用 <strong>SSH</strong> 把家里台式机的相关端口映射到笔记本的本地，就可以获得跟在台式机上开发几乎一致的开发体验。</p>
<p>不过里面也有一点很不爽，就是经常会习惯性的按 <strong>Command + W</strong> 想去关闭 <strong>Code Server</strong> 里的标签页，结果就是触发了浏览器的快捷键，把整个网页都关掉了。</p>
<p>从网上搜索了一下，发现了一个<a target="_blank" rel="noopener" href="https://github.com/cdr/code-server/issues/53#issuecomment-563350766">非常赞的方法</a>，就是通过参数，让 <strong>Chrome</strong> 以 <strong>App</strong> 的形式运行，这样就可以自动屏蔽掉一些快捷键，其中包括 <strong>Command + W</strong>，更厉害的是，<strong>Command + W</strong> 可以像 <strong>IDE</strong> 里一样，关闭当前的代码标签页。</p>
<p>具体命令就是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome --app=http://localhost:8080</span><br></pre></td></tr></table></figure>

<p>如果你是OSX系统，那么命令就是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --app=http://localhost:8080</span><br></pre></td></tr></table></figure>

<p>最后的效果就是这样：</p>
<p><img src="/upload/20200312/WX20200313-013203@2x.png" alt="WX20200313-013203@2x.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/49/">49</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2009 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ETY001</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/ety001" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
