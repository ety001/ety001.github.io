<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon.ico">
  <link rel="mask-icon" href="/img/favicon.ico" color="#222">
  <link rel="manifest" href="/site.webmanifest">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.akawa.ink","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ETY001的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Akawa">
<meta property="og:url" content="https://blog.akawa.ink/page/13/index.html">
<meta property="og:site_name" content="Akawa">
<meta property="og:description" content="ETY001的博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ETY001">
<meta property="article:tag" content="ETY001, akawa, php, vuejs, javascript, docker, steemit, bitshares">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://blog.akawa.ink/page/13/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/13/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Akawa - ETY001的博客</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-60YZJHHP9K"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-60YZJHHP9K","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>







<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7536831447654223" crossorigin="anonymous"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Akawa" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Akawa</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">ETY001的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-生活"><a href="/life" rel="section"><i class="fa fa-bicycle fa-fw"></i>生活</a></li><li class="menu-item menu-item-关于"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-dm实验室"><a href="/lab/" rel="section"><i class="fa fa-gear fa-fw"></i>DM实验室</a></li><li class="menu-item menu-item-捐助"><a href="/donate/" rel="section"><i class="fa fa-star fa-fw"></i>捐助</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-标签云"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签云</a></li><li class="menu-item menu-item-归档"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友链"><a href="/friendsblog/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ETY001"
      src="/img/logo.jpg">
  <p class="site-author-name" itemprop="name">ETY001</p>
  <div class="site-description" itemprop="description">ETY001的博客</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">482</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ety001" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ety001" rel="noopener me" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:work@akawa.ink" title="E-Mail → mailto:work@akawa.ink" rel="noopener me" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/ety001" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;ety001" rel="noopener me" target="_blank"><i class="weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/ety001" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;ety001" rel="noopener me" target="_blank"><i class="twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/10/19/google-play.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/19/google-play.html" class="post-title-link" itemprop="url">原来最干净的安装谷歌套件的方法是这样</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-20 00:00:00" itemprop="dateCreated datePublished" datetime="2018-10-20T00:00:00+08:00">2018-10-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>昨天刷机结束，成功root后，还没有来得及安装谷歌四件套，毕竟很多软件不敢从国内应用商店安装，有些软件则是国内应用商店没有的。</p>
<p>今天使用老方法，去 <a target="_blank" rel="noopener" href="http://www.goplaycn.com/">GoPlayCN</a> 下载回App，然后安装，结果一直在 Google Play 服务那一步安装失败，于是又从网上搜了半天，最后发现正确的安装姿势应该是去 <a target="_blank" rel="noopener" href="https://opengapps.org/">Open Gapps</a> 下载卡刷包，然后进第三方Recovery 直接卡刷。在 <a target="_blank" rel="noopener" href="https://opengapps.org/">Open Gapps</a> 上只要选好自己的CPU是啥架构的，安卓版本是啥，选择什么体型的包，然后下载就ok啦~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/10/18/4c-xposed.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/18/4c-xposed.html" class="post-title-link" itemprop="url">小米4c刷xposed</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-19 00:00:00" itemprop="dateCreated datePublished" datetime="2018-10-19T00:00:00+08:00">2018-10-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近为了研究 <code>xposed</code> 模块开发，我拿我的一块手机跟我妈换了下，把她手里的小米4C换过来，准备用这个作为开发机使用。折腾了一整天，终于是搞定了。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>解锁BL</li>
<li>线刷包 libra_images_6.1.7_20151221.0000.11_5.1_cn_b09dac70a0.tgz</li>
<li>cofface_twrp_recovery.img</li>
<li>SuperSU-v2.79-SR2-20170103_automode_by_kane.apk</li>
<li>XposedInstaller_3.0_alpha4.apk</li>
<li>xposed-v86-sdk22-arm64-MIUI-edition-by-Solar_-20160710.zip</li>
</ul>
<h2 id="下载所需的资源"><a href="#下载所需的资源" class="headerlink" title="下载所需的资源"></a>下载所需的资源</h2><p>准备工作中列出的各种工具，都已放到百度云了，链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1GPumHzCjc89o-jZlKh1V3g">https://pan.baidu.com/s/1GPumHzCjc89o-jZlKh1V3g</a> 提取码: 25xf。其中 <code>cofface_twrp_recovery.img</code> 在 <code>小米4C刷第三方recovery工具2.8.7.3.zip</code> 中。</p>
<h2 id="解锁BL"><a href="#解锁BL" class="headerlink" title="解锁BL"></a>解锁BL</h2><p>先去这里 <a target="_blank" rel="noopener" href="http://www.miui.com/unlock/index.html">http://www.miui.com/unlock/index.html</a> 申请解锁手机BL的资格。BL 就是 BootLoader，解锁后才能修改 BootLoader。</p>
<p>获得解锁资格后如下图所示</p>
<p><img src="/img/2018/10/UkRh6Ph10pIP7MGaLraCrD9AZcBuyEDTriIv5p9Z.png"></p>
<p>然后下载解锁工具。解锁工具只有 Windows 版，因此如果你用的是非 Windows 系统，请自行准备 Windows 系统 或者虚拟机。启动解锁工具，会提示登陆</p>
<p><img src="/img/2018/10/7qF2377KTb81yWPmvKza2LKu1KkFP0fWMvo2hPxP.png"></p>
<p>登陆后，将手机关机进入Fastboot模式（同时按电源键及音量减键），手机上会出现米兔在维修机器人的图标，</p>
<p><img src="/img/2018/10/Yn8HKdkbaOfiRuFIJMIUZayXYNLyizi7EBkMkJWp.png"></p>
<p>然后这时用数据线连接电脑和手机，然后在电脑上点击“解锁”</p>
<p><img src="/img/2018/10/bdHTi9xMCgEjE3geFVuunbaiPPuYu7PxvGNp60id.png"></p>
<p>大约一分钟左右即可完成解锁，然后系统会自动重启。</p>
<h2 id="刷入低版本系统"><a href="#刷入低版本系统" class="headerlink" title="刷入低版本系统"></a>刷入低版本系统</h2><p>目前已知 6.1.7 及以下的版本是没有任何锁的，之后的版本都对 <code>/system</code> 分区加锁了，因此我们需要先刷入低版本的系统。从 <code>http://www.miui.com/shuaji-393.html</code> 这里可以找到通用刷机工具，按照这个网页中的教程操作即可。</p>
<p>刷完后，手机自动重启，第一次重启会很长时间，耐心等待直到进入系统。</p>
<p>做完系统初始化配置后，进入到设置里，找到“关于手机”，一直点击 MIUI版本上 直到开启“开发者选项”，切回设置主菜单，“其他高级设置”里面找到“开发者选项”，打开“USB调试”。</p>
<h2 id="刷入第三方Recovery"><a href="#刷入第三方Recovery" class="headerlink" title="刷入第三方Recovery"></a>刷入第三方Recovery</h2><p>再次进入 Fastboot 模式，手机线连接手机和电脑，在电脑上解压 <code>小米4C刷第三方recovery工具2.8.7.3.zip</code>，如果是 <code>windows</code> 系统，直接执行里面的一个 <code>bat</code> 脚本即可完成第三方 <code>Recovery</code> 刷入。</p>
<p>由于我 Mac 下有 <code>ADB</code> 和 <code>Fastboot</code> 工具，因此我是手动刷入并引导进入 <code>Recovery</code> 的，如下图：</p>
<p><img src="/img/2018/10/UDex969zG9hxmhoTV4LJts2mxhCWz52jzXvqy1hh.jpeg"></p>
<h2 id="对系统进行ROOT"><a href="#对系统进行ROOT" class="headerlink" title="对系统进行ROOT"></a>对系统进行ROOT</h2><p>刷入第三方 <code>Recovery</code> 后，会自动重启进入 <code>Recovery</code>，界面如下图</p>
<p><img src="/img/2018/10/I5Qas0Jcv8se42g1hIZ8XWlWGSjYnmKelbV9OweH.png"></p>
<p>这时在我的电脑里应该能找到手机的SD卡的那个盘，把 <code>SuperSU-v2.79-SR2-20170103_automode_by_kane.apk</code> 拷贝进去，然后回到手机，点击“安装刷机包”，找到 <code>SuperSU-v2.79-SR2-20170103_automode_by_kane.apk</code>，并滑动滑块开始安装，等提示完成后，即可重启手机。进入系统后就能在桌面看到新安装的“超级授权”应用了。</p>
<h2 id="安装-xposed"><a href="#安装-xposed" class="headerlink" title="安装 xposed"></a>安装 xposed</h2><p>从我的电脑里，把 <code>XposedInstaller_3.0_alpha4.apk</code> 和 <code>xposed-v86-sdk22-arm64-MIUI-edition-by-Solar_-20160710.zip</code> 复制进手机SD卡。在手机上安装 <code>XposedInstaller_3.0_alpha4.apk</code>。</p>
<p>安装后，进入 <code>Recovery</code> 模式，即一直按住电源键和音量增键，直至出现开机Logo的时候，松开电源键，再等几秒后，进入 <code>Recovery</code>，这时松开音量增键。</p>
<p>点击进入“安装刷机包”，选择 <code>xposed-v86-sdk22-arm64-MIUI-edition-by-Solar_-20160710.zip</code>，滑动进行确认后开始安装，完成后重启手机。进入系统后，打开 <code>xposed installer</code> 点击“框架”，就能看到如下的字样</p>
<p><img src="/img/2018/10/roVYl0V9QEIrOv0knnKf0Qz3Yi3ENQHA326VpcFl.png"></p>
<p>说明我们的 <code>xposed</code> 已经安装好了。</p>
<p>为了测试下是否安装正确，我安装了一个微信机器人的模块，并且把微信机器人放到了群里测试了下，效果如下：</p>
<p><img src="/img/2018/10/UYG0JYVq5CO0gNxEcNx3N8ZrrXWjoWISYCRv0QUR.png"></p>
<p>至此，完成！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/10/11/cordova.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/11/cordova.html" class="post-title-link" itemprop="url">最近折腾 cordova 遇到的问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-12 00:00:00" itemprop="dateCreated datePublished" datetime="2018-10-12T00:00:00+08:00">2018-10-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="1-A-valid-provisioning-profile-for-this-executable-was-not-found"><a href="#1-A-valid-provisioning-profile-for-this-executable-was-not-found" class="headerlink" title="1. A valid provisioning profile for this executable was not found."></a>1. A valid provisioning profile for this executable was not found.</h4><p>这个问题，在网上搜了很久，有很多种可能会导致这个问题。我遇到这个问题的解决方案是：</p>
<p>File &gt; Workspace Settings &gt; Set Build system to “Legacy Build System”</p>
<h4 id="2-Cannot-read-property-‘semver’-of-null"><a href="#2-Cannot-read-property-‘semver’-of-null" class="headerlink" title="2. Cannot read property ‘semver’ of null"></a>2. Cannot read property ‘semver’ of null</h4><ul>
<li>find the path <project_root>&#x2F;platforms&#x2F;android&#x2F;cordova&#x2F;lib&#x2F;emulator.js</li>
<li>find the line <code>avd.target = &#39;Android &#39; + level.semver + &#39; (API level &#39; + api_level + &#39;)&#39;;</code></li>
<li>replace it with <code>avd.target = &#39;Android &#39; + (level ? level.semver : &#39;&#39;) + &#39; (API level &#39; + api_level + &#39;)&#39;;</code></li>
</ul>
<h4 id="3-如果-build-的时候显示-Error-spawn-EACCES"><a href="#3-如果-build-的时候显示-Error-spawn-EACCES" class="headerlink" title="3. 如果 build 的时候显示 Error: spawn EACCES"></a>3. 如果 build 的时候显示 Error: spawn EACCES</h4><p>这个错误说明你正在使用的程序没有执行权限，通过给 <code>cordova</code> 命令增加 <code>--verbose</code> 参数，可以看到是哪个程序执行不了，然后给这个程序加上执行权限即可</p>
<h4 id="4-cordova-build-之前先配置好环境变量"><a href="#4-cordova-build-之前先配置好环境变量" class="headerlink" title="4. cordova build 之前先配置好环境变量"></a>4. cordova build 之前先配置好环境变量</h4><p>详细的安装配置需要去看下 <code>cordova</code> 的官方文档，这里只是强调下环境变量的配置。这里分享下我的环境变量配置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/Applications/Android\ Studio.app/Contents/jre/jdk/Contents/Home</span><br><span class="line">export ANDROID_HOME=/Users/ety001/Library/Android/sdk</span><br><span class="line">export PATH=$&#123;PATH&#125;:$&#123;JAVA_HOME&#125;/bin:$&#123;ANDROID_HOME&#125;:$&#123;ANDROID_HOME&#125;/platform-tools:$&#123;ANDROID_HOME&#125;/tools:$&#123;ANDROID_HOME&#125;/tools/bin</span><br></pre></td></tr></table></figure>

<p>把上面的配置加到你的 <code>~/.bashrc</code> 或者如果你要用的是 <code>zsh</code> 的话就是 <code>~/.zshrc</code>。</p>
<h4 id="5-代码更新"><a href="#5-代码更新" class="headerlink" title="5. 代码更新"></a>5. 代码更新</h4><p>代码修改后，需要先 <code>npm run build</code> ，也就是先把 <code>js</code> 编译好，编译好后的静态文件会在项目根目录的 <code>www</code> 目录中，再执行 <code>cordova prepare -d</code> 就会把静态文件复制到各个 <code>platform</code> 的 <code>www</code> 目录里面。</p>
<h4 id="6-如何使用-Safari-和-Chrome-调试-app"><a href="#6-如何使用-Safari-和-Chrome-调试-app" class="headerlink" title="6. 如何使用 Safari 和 Chrome 调试 app"></a>6. 如何使用 Safari 和 Chrome 调试 app</h4><ul>
<li>ios的话，先在手机上找到 “设置” &#x3D;&gt; “Safari浏览器” &#x3D;&gt; “高级” &#x3D;&gt; 把 “Web 检查器” 选中，然后用手机线把手机和电脑连接，电脑上打开 “Safari 浏览器”，”偏好设置” &#x3D;&gt; “高级” &#x3D;&gt; 选中 “在菜单栏显示开发菜单”，最后打开手机上的 App，这样在 Safari 的 “开发” 菜单中就能看到你的手机名的菜单了，选中其中的 app 名字就能打开 <code>inspect</code> 进行调试了。</li>
<li>android的话，也差不多的流程，在 Chrome 浏览器里访问 <code>chrome://inspect</code>，使用 <code>debug</code> 模式打开模拟器里要调试的 app 后，在 Chrome 浏览器里就能看到信息了，点击 <code>inspect</code> 就能打开针对这个 app 的调试窗口。需要注意的是，调试窗口里面的调试器需要翻墙，可以先用浏览器访问 <code>https://chrome-devtools-frontend.appspot.com/serve_rev/@180870/devtools.html</code> ，然后把这个网址加入到白名单里面，再回到 <code>inspect</code> 就可以看到调试界面了（这里我折腾了一天多，最终才发现是墙的问题😂）。</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/10/09/conductor-docker.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/09/conductor-docker.html" class="post-title-link" itemprop="url">把 conductor 封装进 docker</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-10 00:00:00" itemprop="dateCreated datePublished" datetime="2018-10-10T00:00:00+08:00">2018-10-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>今天才发现，自从上次重装服务器后，一直忘记恢复 <code>Steem</code> 见证人的喂价程序了。之前一直使用的是 @furion 开发的 <a target="_blank" rel="noopener" href="https://github.com/Netherdrake/conductor">conductor</a>，并且之前没有用 <code>Dockerfile</code> 封装成镜像，而是直接在 <code>ubuntu:16.04</code> 的镜像上启动容器，添加的命令。这次就直接做成镜像方便以后使用。</p>
<h2 id="镜像文件"><a href="#镜像文件" class="headerlink" title="镜像文件"></a>镜像文件</h2><ul>
<li><p>你可以自己编译，<code>Dockerfile</code> 如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FROM alpine:3.6</span><br><span class="line">RUN apk add --no-cache python3 python3-dev gcc git musl-dev libffi-dev openssl-dev \</span><br><span class="line">    &amp;&amp; pip3 install -U git+git://github.com/Netherdrake/steem-python \</span><br><span class="line">    &amp;&amp; pip3 install -U git+https://github.com/Netherdrake/conductor \</span><br><span class="line">    &amp;&amp; apk del git gcc musl-dev libffi-dev python3-dev</span><br><span class="line">ENV UNLOCK=123456</span><br><span class="line">CMD [&quot;conductor&quot;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>也可以直接用我封装好的，<code>docker pull ety001/steem-conductor</code>。</p>
</li>
</ul>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><ul>
<li><p>添加 active_key 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm -v ~/.local/share/steem:/root ety001/steem-conductor /bin/ash</span><br></pre></td></tr></table></figure>
<p>执行后，进入容器，再执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steempy addkey</span><br></pre></td></tr></table></figure>
<p>输入 <code>active key</code> 后就可以把你要操作的用户加入到本地数据库里了，数据库文件最终会存储在你宿主机的 <code>~/.local/share/steem/.local/share/steem</code> 位置。添加好以后，执行 <code>exit</code> 退出容器环境即可，效果如下图：<br><img src="/img/2018/10/W5gkMOnNlicX27TEaefIrXHj5T1C8jzztFVibMCv.png"></p>
</li>
<li><p>初始化 <code>conductor</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm -v ~/.local/share/steem:/root ety001/steem-conductor conductor init</span><br></pre></td></tr></table></figure>
<p><img src="/img/2018/10/Wn36kvnMBbvTyKj1FDRxknaV4s6XqqAllGmgoU9d.png"></p>
</li>
<li><p>测试喂价程序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm -v ~/.local/share/steem:/root ety001/steem-conductor conductor feed</span><br></pre></td></tr></table></figure>
<p><img src="/img/2018/10/oyrpAWa4MFtSsI8A8AFYO5VzJmM5R3UpZsbAdKJZ.png"><br>可以工作</p>
</li>
<li><p>启动喂价容器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name steem-feed -v ~/.local/share/steem:/root --restart always ety001/steem-conductor conductor feed</span><br></pre></td></tr></table></figure>
<p><img src="/img/2018/10/My7FKQkHkc5j5JMP5nVyeg9sjxXEuoqUdIvhJYil.png"></p>
</li>
</ul>
<p>完工！以后再部署喂价程序，两行命令就搞定了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/10/08/easy-startup-tuturial-for-hapi.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/08/easy-startup-tuturial-for-hapi.html" class="post-title-link" itemprop="url">使用 hapijs 快速构建自己的 api 服务</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-09 00:00:00" itemprop="dateCreated datePublished" datetime="2018-10-09T00:00:00+08:00">2018-10-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/img/2018/10/8.png"></p>
<p>最近接手的 <code>Stellar</code> 钱包的外包小活需要搭建个 <code>API</code> 服务，考虑再三，由于 <code>Stellar SDK</code> 中我只会 <code>Javascript</code>，因此打算使用 <code>Nodejs</code> 去完成这个服务搭建工作。</p>
<p>大约5年前曾经用 <code>Express</code> 框架搭建过一个记事本网站，不过这次是做 <code>API</code>，用 <code>Express</code> 感觉好像太重了，于是搜索了下，发现了 <a target="_blank" rel="noopener" href="https://hapijs.com/">hapi</a> 这个框架。</p>
<p>说干就干。</p>
<p>首先初始化一个 <code>Nodejs</code> 项目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure>

<p>然后安装一下 <code>hapi</code>，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hapi -s</span><br></pre></td></tr></table></figure>

<p>创建一个 <code>index.js</code> 文件，并粘贴下面的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">const Hapi = require(&#x27;hapi&#x27;);</span><br><span class="line">const server = Hapi.server(&#123;</span><br><span class="line">    port: 8877,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.route(&#123;</span><br><span class="line">  method: &#x27;GET&#x27;,</span><br><span class="line">  path: &#x27;/&#x27;,</span><br><span class="line">  options: &#123;</span><br><span class="line">    cors: true</span><br><span class="line">  &#125;,</span><br><span class="line">  handler: (request, h) =&gt; &#123;</span><br><span class="line">    return &#x27;Hello, &#x27; + request.query.r;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const init = async () =&gt; &#123;</span><br><span class="line">  await server.start();</span><br><span class="line">  console.log(`Server running at: $&#123;server.info.uri&#125;`);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">process.on(&#x27;unhandledRejection&#x27;, (err) =&gt; &#123;</span><br><span class="line">  console.log(err);</span><br><span class="line">  process.exit(1);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">init();</span><br></pre></td></tr></table></figure>

<p>启动一下，并访问 <code>http://localhost:8877/?r=ety001</code>，会看到 <code>Hello, ety001</code>。</p>
<p>这样最简单的 <code>API</code> 服务就搞定了。</p>
<blockquote>
<p>这里需要注意下 cors 这个配置，这个设置为 true，就可以避免跨域的报错，不过安全性需要注意，详细的配置参数请看 hapi 的文档。</p>
</blockquote>
<p>除此之外，我还加入了缓存。因为每次去获取 <code>Trade Aggregation</code> 数据都需要大约5–6秒，这样的性能还是不行的。因此加入一个10秒的缓存，10秒内访问，将会返回缓存数据。</p>
<p>加入方法很简单，大致的代码结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const getTradePair = async (pointPair) =&gt; &#123;</span><br><span class="line">  // the code to get trade pairs and trade aggregation</span><br><span class="line">&#125;</span><br><span class="line">const traidPairCache = server.cache(&#123;</span><br><span class="line">  expiresIn: 10 * 1000,</span><br><span class="line">  segment: &#x27;customSegment&#x27;,</span><br><span class="line">  generateFunc: async (pair) =&gt; &#123;</span><br><span class="line">    return await getTradePair(pair);</span><br><span class="line">  &#125;,</span><br><span class="line">  generateTimeout: 20000</span><br><span class="line">&#125;);</span><br><span class="line">server.route(&#123;</span><br><span class="line">  method: &#x27;GET&#x27;,</span><br><span class="line">  path: &#x27;/v2/api/trade_aggregations&#x27;,</span><br><span class="line">  options: &#123;</span><br><span class="line">    cors: true</span><br><span class="line">  &#125;,</span><br><span class="line">  handler: async (request, h) =&gt; &#123;</span><br><span class="line">    return await traidPairCache.get(&#x27;pair&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这里说明下。 <code>traidPairCache</code> 中 <code>generateFunc</code> 方法就是在缓存未命中的时候，去获取新数据的方法。第一个参数相当于是缓存的标示，<code>generateTimeout</code> 就是 <code>generateFunc</code> 的执行超时时间。</p>
<blockquote>
<p>hapi 使用 <a target="_blank" rel="noopener" href="https://github.com/hapijs/catbox">catbox</a> 来实现缓存，框架默认使用 <code>memory</code> 作为缓存介质。</p>
</blockquote>
<p>以上就是目前我所用到的功能，<code>hapi</code> 框架真的很轻，在处理些类似我这样的需求的时候，最省时间，尤其再配合 <code>Docker</code>，把服务直接做成镜像，部署起来也就一句话的事儿~~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/09/15/fu-sheng-liu-ji.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/15/fu-sheng-liu-ji.html" class="post-title-link" itemprop="url">初读《浮生六记》</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-16 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-16T00:00:00+08:00">2018-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/img/2018/10/6.png"></p>
<p>昨天买了《浮生六记》回来看，最早听到《浮生六记》应该是在语文课上的课文里，“余忆童稚时，能张目对日，明察秋毫……”，这也是这次买这本书的原因了。</p>
<p>一直好奇《浮生六记》讲了什么，买回来看了序才知道原来写的是夫妻之间的家庭生活之事。于是有些怀疑写一些琐事是如何能获得200来年里各种大文学家的好评的。于是耐下心去读，看看到底是个什么。</p>
<p>读完前两记，起初还是有些不耐烦的，但是随着阅读反而平静了下来。文字虽不奢华，但是叙事中却不让人觉得是在记流水账。读完真的是可以感受到了一股浓浓的生活气息。</p>
<p>与其说这个是部散文选，不如说这其实是一部纪录片，就好像我们每天在用微信发朋友圈来记录我们的生活似的，但是《浮生六记》却不给人一种无聊的感觉，又能记录下精彩丰富的生活，实在是很让人惊叹。</p>
<p>继续阅读剩下的四记去了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/08/25/shopping-list-wechat.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/25/shopping-list-wechat.html" class="post-title-link" itemprop="url">给媳妇做了一个购物清单的微信小程序，欢迎其他家庭煮妇（夫）使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-26 00:00:00" itemprop="dateCreated datePublished" datetime="2018-08-26T00:00:00+08:00">2018-08-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>媳妇有个好习惯，就是每次去超市都会把要买的东西记录到纸上。</p>
<p>但是每次到了超市就会发现，不是忘带了那张纸，就是纸找不到放到哪里了😂。</p>
<p>于是我花了一天多的时间给媳妇做了个微信小程序用来实现记录要买的东西。</p>
<p>现在公开出来，大家也可以使用了，微信扫描文末的小程序码即可~</p>
<p>下面是演示视频：</p>
<p><a target="_blank" rel="noopener" href="https://youtu.be/QjVA0QCWK6I">Youtube</a></p>
<p><a target="_blank" rel="noopener" href="http://v.youku.com/v_show/id_XMzc5ODM2MjM0MA==.html">优酷</a></p>
<p>因为最初也是为了自己用，因此把需求砍到了最精简，直接输入添加要买的东西即可。<br>删除的话，只需要长按就可以了。<br>由于考虑到经常去超市购买的物品大致相同，所以增加了一个历史记录的功能，<br>这样下次再添加要买物品的时候，可以从历史记录里直接点按即可添加。<br>另外把小程序添加进“我的小程序”中，可以从微信首页下拉菜单中快速进入~</p>
<p>欢迎各位家庭煮妇（夫）使用，也欢迎分享给更多的家庭煮妇（夫）~</p>
<p>PS：据说有人还要用这个来记录其他的东西，而不仅仅是超市购物使用🤔。</p>
<p><img src="/img/2018/10/7.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/08/24/3g-dongle-router.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/24/3g-dongle-router.html" class="post-title-link" itemprop="url">优酷路由宝刷padavan使用3G卡托上网</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-25 00:00:00" itemprop="dateCreated datePublished" datetime="2018-08-25T00:00:00+08:00">2018-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>昨天收到了新买的二手网件路由，预刷的梅林系统，今天上午花了一个多小时把家里的主路由（米3）替换成新买的网件，在配置梅林的时候，发现梅林支持USB 3G Dongle。突然就想到了我之前买的，已经闲置了的优酷路由宝L1，里面我刷了不死 breed，可以考虑拿那个路由折腾下，正好手里有联通的大天王卡（每天3块钱无限流量）可以测试。</p>
<p>其实这个月初就在考虑怎么用这个天王卡，但是由于急着去青岛度假，时间匆忙，就拿了个 Android 手机当路由使。实际的体验效果是，手机终归是手机，可以带的设备数还是很有限的，同时4台手机上网就很卡了。这次正好发现梅林支持我手里的华为E1750C，于是就准备拿已经闲置的优酷路由宝L1开试（路由宝的配置对于这个价位还是很良心的）。</p>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>首先要做的就是刷入系统。从网上搜索了下，路由宝的Flash容量不足以装下梅林系统，但是可以装下老毛子的 Padavan ，所以去下载了 Padavan 的固件（Google搜索 <code>rt-n14u-gpio-1-youku1-128m_3.4.3.9-099.trx</code> 即可找到）。因为我之前路由宝里已经刷入了 breed，所以写入新固件很轻松，只需要断电状态下，按住 Reset 键，然后送电，等待大约 2s 松开 Reset ，然后网线连接路由的 Lan 口，访问 <code>192.168.1.1</code> 打开 Breed，上传固件刷入即可。</p>
<p><img src="/img/2018/10/1.jpeg"></p>
<p>写入成功后，路由会自动重启，重启后，找到新的IP地址是 <code>192.168.123.1</code> 访问下，在 <strong>高级设置</strong> &gt; <strong>USB应用程序</strong> 中，找到 <strong>USB调制解调器</strong> ，国家选择 <strong>China</strong>，应用设置即可。</p>
<p><img src="/img/2018/10/2.jpeg"></p>
<p>回到 <strong>网络地图</strong>，点击那个地球，就能看到连接方式变成了 <strong>USB调制解调器（总是）</strong>，过一会 <strong>连接状态</strong> 就会显示 <strong>已连接</strong>。</p>
<p><img src="/img/2018/10/3.jpeg"></p>
<p>这时就能开心的使用流量上网了。由于是个3G的卡托，所以速度还是不理想，对于4G卡来说有些浪费了。以后再有机会的时候，换个4G卡托。目前来看，虽然带宽小了些，但是浏览网页看个视频还是没有问题的。</p>
<p><img src="/img/2018/10/4.png"></p>
<p>最后附一张设备图</p>
<p><img src="/img/2018/10/5.jpg" alt="d0.jpg"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/08/21/rebuild-my-steem-witness-server.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/21/rebuild-my-steem-witness-server.html" class="post-title-link" itemprop="url">见证人服务器重做系统中</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-22 00:00:00" itemprop="dateCreated datePublished" datetime="2018-08-22T00:00:00+08:00">2018-08-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>一周三次出块都失败了，也不知道服务器到底抽了什么风，于是索性就重装系统吧，顺便把 <code>zram</code> 也折腾下。重做系统的时候没有再选择 <code>ubuntu16.04</code>，而是选择了我最熟悉的 <code>Archlinux</code>。重做很快就结束了，登陆系统看了下，还是 <code>Arch</code> 精简干练，即使把所有需要的软件都装完，内存依然占用很少。</p>
<p><img src="https://steemeditor.com/storage/images/qXkl0bBuInhSWACOHmGeY2VzTeaDKBTmuh61nwkI.png"></p>
<p>由于我还是打算在 <code>docker</code> 里面跑见证人，所以先安装 <code>docker</code>，执行 <code>pacman -S docker</code> 搞定。</p>
<p>然后安装一个轻量的管理 <code>docker</code> 界面 <code>portainer</code>，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># docker volume create portainer_data</span><br><span class="line"># docker run -d -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock --name portainer --restart always -v portainer_data:/data portainer/portainer</span><br></pre></td></tr></table></figure>

<p>安装好，直接浏览器访问 <code>IP:9000</code> ，配置上用户名和密码，选择本地模式，搞定。</p>
<p>接下来就是做个文件的 <code>swap</code>，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># fallocate -l 50G /swapfile</span><br><span class="line"># mkswap /swapfile</span><br><span class="line"># swapon /swapfile</span><br><span class="line"># echo &#x27;/swapfile none swap sw 0 0&#x27; | tee -a /etc/fstab</span><br></pre></td></tr></table></figure>

<p>然后安装 <code>zramswap</code>，由于 <code>zramswap</code> 是在 <code>AUR</code> 里，所以先安装一下 <code>makepkg</code> 所要用到的编译环境</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># pacman -S base-devel</span><br></pre></td></tr></table></figure>

<p>然后新建一个普通用户，并切换到该用户的家目录，然后下载 <code>zramswap</code> 的安装包（在 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/zramswap/">https://aur.archlinux.org/packages/zramswap/</a> 这里能找到下载地址），解压后编译安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://aur.archlinux.org/cgit/aur.git/snapshot/zramswap.tar.gz</span><br><span class="line">$ tar xvf zramswap.tar.gz</span><br><span class="line">$ cd zramswap</span><br><span class="line">$ makepkg -si</span><br></pre></td></tr></table></figure>

<p>安装好以后，确认下 <code>zram</code> 模块是否加载，如果没有加载的话，加载下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># lsmod | grep zram</span><br><span class="line"># modprobe zram</span><br></pre></td></tr></table></figure>

<p>启动 <code>zramswap</code> 并设置为开机自启动，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># systemctl start zramswap</span><br><span class="line"># systemctl enable zramswap</span><br></pre></td></tr></table></figure>

<p>检查是否正常</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># zramctl</span><br><span class="line">NAME       ALGORITHM DISKSIZE DATA COMPR TOTAL STREAMS MOUNTPOINT</span><br><span class="line">/dev/zram9 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram8 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram7 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram6 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram5 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram4 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram3 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram2 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram1 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram0 lz4        1006.3M   4K   69B    4K      10 [SWAP]</span><br><span class="line"></span><br><span class="line"># swapon</span><br><span class="line">NAME       TYPE         SIZE USED PRIO</span><br><span class="line">/swapfile  file          50G   0B   -2</span><br><span class="line">/dev/zram0 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram1 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram2 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram3 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram4 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram5 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram6 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram7 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram8 partition 1006.3M   0B  100</span><br><span class="line">/dev/zram9 partition 1006.3M   0B  100</span><br></pre></td></tr></table></figure>

<p>发现 <code>zramswap</code> 只分配了10G内存，于是去查了下他的启动文件 <code>/usr/lib/systemd/system/zramswap.service</code>，发现最终执行的文件是 <code>/usr/lib/systemd/scripts/zramctrl</code>，打印下 <code>zramctrl</code> 的内容，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># cat /usr/lib/systemd/scripts/zramctrl </span><br><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">start() &#123;</span><br><span class="line">  exec awk -v ZRAM_SIZE=$ZRAM_SIZE -v ZRAM_PARM=&quot;$(modinfo zram | grep -E -o &#x27;(num_devices|zram_num_devices)&#x27;)&quot; &#x27;</span><br><span class="line"></span><br><span class="line">  FILENAME == &quot;/proc/cpuinfo&quot; &amp;&amp; ($1 == &quot;processor&quot; || $1 == &quot;Processor&quot;) &#123;</span><br><span class="line">    cpucount++</span><br><span class="line">    next</span><br><span class="line">  &#125;</span><br><span class="line">  FILENAME == &quot;/proc/meminfo&quot; &amp;&amp; $1 == &quot;MemTotal:&quot; &#123;</span><br><span class="line">    if (ZRAM_SIZE == &quot;&quot;)</span><br><span class="line">      ZRAM_SIZE = 20</span><br><span class="line">    mem_total = int( (0 + $2) * 1024 * ( ZRAM_SIZE/100 ) )</span><br><span class="line">    next</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">....以下代码省略</span><br></pre></td></tr></table></figure>

<p>发现需要设置一个 <code>$ZRAM_SIZE</code> 的环境变量，否则默认20%。在 <code>/usr/lib/systemd/system/zramswap.service</code> 中增加环境变量，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Zram-based swap (compressed RAM block devices)</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">Environment=&quot;ZRAM_SIZE=100&quot;   # 这里是增加的环境变量</span><br><span class="line">ExecStart=/usr/lib/systemd/scripts/zramctrl start</span><br><span class="line">ExecStop=/usr/lib/systemd/scripts/zramctrl stop</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>重载配置文件并重启 <code>zramswap</code>，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># systemctl daemon-reload</span><br><span class="line"># systemctl restart zramswap</span><br></pre></td></tr></table></figure>

<p>再次查看 <code>zram</code> 状态，发现已经搞定。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># zramctl</span><br><span class="line">NAME       ALGORITHM DISKSIZE DATA COMPR TOTAL STREAMS MOUNTPOINT</span><br><span class="line">/dev/zram9 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram8 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram7 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram6 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram5 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram4 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram3 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram2 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram1 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br><span class="line">/dev/zram0 lz4           4.9G   4K   69B    4K      10 [SWAP]</span><br></pre></td></tr></table></figure>

<p>接下来就是去部署 @someguy123 的见证人镜像了，这个在之前写过教程，就不再细说了，这是链接 <a target="_blank" rel="noopener" href="https://steemit.com/cn/@ety001/5xtjgz">https://steemit.com/cn/@ety001/5xtjgz</a> 。</p>
<p>看目前下载离线区块数据的速度应该不是网络卡导致的丢块，难道是之前配置的 <code>shared-file-size</code> 有问题？等部署完见证人运行起来再观察下看看还会不会频繁的丢块了吧。。。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.akawa.ink/2018/07/16/summary-of-fixing-btsbots.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/logo.jpg">
      <meta itemprop="name" content="ETY001">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Akawa">
      <meta itemprop="description" content="ETY001的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Akawa">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/07/16/summary-of-fixing-btsbots.html" class="post-title-link" itemprop="url">对于btsbots修复进程的阶段性总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-07-17 00:00:00" itemprop="dateCreated datePublished" datetime="2018-07-17T00:00:00+08:00">2018-07-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-08 18:20:06" itemprop="dateModified" datetime="2024-04-08T18:20:06+08:00">2024-04-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>25天前填完 <a target="_blank" rel="noopener" href="https://steemit.com/utopian-io/@ety001/lightdb-v0-0-2-has-been-released">LightDB</a> 的坑以后，就开始研究 <strong>alt</strong> 留下的那个 <strong>btsbots</strong> 的 <a target="_blank" rel="noopener" href="https://github.com/pch957/btsbots-demo-2016">代码</a> 了。之前也有<a target="_blank" rel="noopener" href="https://steemit.com/notbtsbots/@aperson/introducing-not-btsbots">团队在修复这套代码</a> ，但是考虑到这么重要的一个设施，还是把核心技术握在自己手里比较好，要不然哪天那个团队歇菜了，又要凉。</p>
<p>代码断断续续的看了将近一个月了，总的感受就是崩溃。</p>
<p>从我开始参加工作开始，接的活都是半路加入救火的，没有人指导，只有代码，基本上是靠分析输出数据和看代码来逆向梳理需求的。但是这次修复 <strong>btsbots</strong> 的难度加大了，因为不会 *C++*，只能对着各种输出数据去逆向推理 <strong>btsbots</strong> 的代码到底想要做什么，为什么这么做。所以等这个 <strong>btsbots</strong> 修好，还是要找时间去学 <strong>C++</strong> 了。</p>
<p>目前并没有什么实质的代码修改，还停留在分析代码的阶段，该文就是基于目前我对于 <strong>btsbots</strong> 的理解进行的总结。</p>
<p>最简单的做市需要的数据无非就是当前账户内各种币剩多少，交易对是否满足下单要求，是否有订单需要取消。<strong>btsbots</strong> 的思路其实很简单，就是基于 <strong>1.11.x</strong> 这个 <strong>operation history object</strong> 来把链上的所有操作 <strong>replay</strong> 一遍，然后得到所有用户的 <strong>balance</strong> 和所有的交易对深度数据。</p>
<p><strong>btsbots</strong> 项目使用 <strong>python</strong> 来完成从链上取数据并 <strong>replay</strong> 的操作，然后存入 <strong>MongoDB</strong>，最后基于 <strong>Meteor</strong> 开发了应用界面来读取 <strong>MongoDB</strong> 中的数据并展示，用户可以设置自己的做市逻辑并在浏览器本地完成下单和取消订单的签名操作。</p>
<p>思路很明确，但是比较让人恶心的就是数据和需求的分析了。</p>
<p>目前几乎所有的时间都在分析 <strong>scripts</strong> 目录下的 <strong>python</strong> 代码的逻辑，因为这一块之前在试跑的时候，数据一直有问题。</p>
<p><strong>scripts</strong> 目录下主要就是 <strong>correct-balance.py</strong> , <strong>monitor.py</strong>, <strong>statistics.py</strong> 这三个文件。</p>
<p>这三个文件中，<strong>monitor.py</strong> 和 <strong>statistics.py</strong> 这两个的目的我是最明确的了，<strong>correct-balance.py</strong> 的目的一直很糊涂。</p>
<p>之前忘记在哪里看到的部署文档说，第一次运行 <strong>btsbots</strong> 的时候，要先运行  <strong>correct-balance.py</strong> 进行 <strong>balance</strong> 和 <strong>order</strong> 的初始化。然而看 <strong>correct-balance.py</strong> 的代码中，只是去获取 <strong>1.8.x</strong> 这一种类型的订单的数据和 <strong>2.5.x</strong> 的 <strong>balance</strong> 数据。在代码的头部，你需要指定 <strong>x</strong> 的上限，如下图</p>
<p><img src="https://steemeditor.com/storage/images/Nch5576DeiraOIHgnlm6TV0jZylxGfTFM7CYNGsv.png"></p>
<p>然后循环获取从 <strong>1.8.0</strong> 到 <strong>1.8.x</strong> 获取订单数据并插入数据库，从 <strong>2.5.0</strong> 到 <strong>2.5.x</strong> 获取 <strong>balance</strong> 数据并插入数据库。完成这两步以后，会再遍历一遍已经插入数据库的订单数据，然后去更新数据库里已经存下来的 <strong>balance</strong>，如图：</p>
<p><img src="https://steemeditor.com/storage/images/oOX8LmuGG982GhBZg9tcBkixpcJQPyEVztDOl3Gf.png"></p>
<p><img src="https://steemeditor.com/storage/images/tsQErm0jNo9E8696zGG1lh0KuMywInXe9oeEEiAr.png"></p>
<p><img src="https://steemeditor.com/storage/images/yO62x3OpZuFbLEl5V03q0VNfHvzIwNyPn5HXKgol.png"></p>
<p><img src="https://steemeditor.com/storage/images/IhKwYQ8xhNHLoAOLMQGfF9oIdqsxIK14qoiAxNAV.png"></p>
<p>这里我就有疑问了!!!</p>
<p>首先是为什么第一次获取数据只获取 <strong>1.8.x</strong> 这一种类型的订单，而在下面的 <strong>add_b_from_o</strong> 函数中却有 <strong>1.4.x</strong> 和 <strong>1.7.x</strong> 的处理逻辑？</p>
<p>其次就是获取到的 <strong>2.5.x</strong> 是最新的 <strong>balance</strong> 数据，而拿着订单中的 <strong>amount</strong> 在最新 <strong>balance</strong> 上加减是不是错误的？我通过自己手动从 <strong>API</strong> 获取到的 <strong>2.5.x</strong> 的数据来看，拿到的这些 <strong>balance</strong> 数据都是刨除掉未成交订单额度后的，而在 <strong>btsbots</strong> 中却又在 <strong>2.5.x</strong> 的数据的基础上去刨除订单额度貌似是不对的，但是现在我又不敢确定，因为我不确定 <strong>1.4.x</strong>, <strong>1.7.x</strong>, <strong>1.8.x</strong>这些数据是代表的是未成交的订单，还是所有的订单。</p>
<p>最后就是感觉这里处理 <strong>balance</strong> 的方法跟 <strong>monitor.py</strong> 的处理方法是冲突的，这里先按下不表。我们先去看 <strong>monitor.py</strong> 的代码。</p>
<p>在 <strong>monitor.py</strong> 中，思路很简单，就是获取 <strong>1.11.x</strong>，然后根据各种不同的 <strong>operation type</strong> 来分别处理数据，最后把数据更新进数据库。这个脚本里的疑问也是有不少。</p>
<p>首先是怎么触发的问题，先看下图的代码，</p>
<p><img src="https://steemeditor.com/storage/images/acKGEdCdTl7bePOxqz3z2hkG5XrWJf6AvsoQ2vEL.png"></p>
<p>其中 63 行是我补上的代码。与第 63 行类似的代码其实在这个类初始化的时候已经执行过了，这个在<a target="_blank" rel="noopener" href="https://github.com/pch957/python-bts/blob/master/bts/ws/base_protocol.py#L87">这里</a>可以看到。在 <strong>python-bts</strong> 库里，默认是把 <strong>clear_filter</strong> 置为 <strong>false</strong> 了，这意味着只有你发送了 <strong>get_object</strong> 的指令，服务端才会推送你刚才获取的那个 <strong>object</strong> 的变动。</p>
<p>在没有我补上的 63 行的代码之前，执行 <strong>monitor.py</strong> 其实是没有任何数据进数据库的，因为所有的插入数据库的操作都在 <strong>onOperation</strong> 里面，而 <strong>onOperation</strong> 的触发是在用户订阅的 <strong>1.11.x</strong> 的 <strong>object</strong> 有变动的时候才会触发，而程序代码从开始运行，就没有 <strong>get_object</strong> 的操作，所以服务端并不知道你想要获取哪个 <strong>object</strong> 的变动信息。加上 63 行后，把 <strong>clear_filter</strong> 置为 <strong>true</strong>，那么服务端就会推送所有的 <strong>object</strong> 的变动信息了。</p>
<p>其次就是语言方面的问题了，如下图</p>
<p><img src="https://steemeditor.com/storage/images/Cgrg1g3FiSB4jsBuKHx5xHO5X22YXWcgjfOwMeQq.png"></p>
<p>由于我写 <strong>python</strong> 的时间不久，这里并不明白加锁的意义。如果加锁是为了保证共享资源的修改顺序的话，为啥还要用协程来异步？这里我还需要再多看看这方面的文章去了解下协程中的锁的目的。</p>
<p>然后这里第 41 行的代码在执行的时候也有问题。在这个类的父类中，看到作者最早是把 <strong>op_id_begin</strong> 置为 <strong>1.11.0</strong> 的，在从数据库中取不到数据的时候（也就是说第一次运行的时候），但是现在注释掉了，改为了置为 <strong>None</strong>，这就导致这里的代码如果按照作者原先的逻辑，就是从当前程序执行的时刻起，开始数据的同步。这也是之前那个团队修复的 <strong>btsbots</strong> 为何不支持老账户的原因。这里我改回到 <strong>1.11.0</strong> 后，运行程序跑了一天多后，发现有报错，大致意思就是插入的数据的索引有重复导致插入失败。这个问题现在还没有去深究原因。</p>
<p>最后为解决的难点就是这个 <strong>monitor.py</strong> 对 <strong>operation</strong> 的处理了。先看下面两个截图感受下</p>
<p><img src="https://steemeditor.com/storage/images/wTy4zQxaCv5efixHejOjxU8jtJ71Nbi9u2WKCXGI.png"></p>
<p><img src="https://steemeditor.com/storage/images/CBQGHbM8uTVwJiqCmuf45N07MXwOIIoaaduZ6lUx.png"></p>
<p>第一个截图中，是初始化了所有类型的 <strong>op</strong>，从 <strong>btsbots</strong> 的代码里看，截止到这份代码的最后修改时间，一共有 44 个类型，这里比较蛋疼的就是之后的 <strong>bitshares-core</strong> 中是否有再新增类型吗？由于我看不懂 **C++**，所以这里就会不确定。这 44 个类型里，有些没有手续费的类型，就去掉了没有处理，因为这个对于 <strong>balance</strong> 不产生影响，剩下的类型由 16 个 <strong>handler</strong> 处理，这里就有疑问了。大致扫过这些 <strong>handler</strong>，里面也有对数据库中的 <strong>balance</strong> 的操作，那么这里通过 <strong>1.11.x</strong> 对 <strong>balance</strong> 进行的操作与 <strong>correct-balance.py</strong> 文件中，通过 <strong>1.8.x</strong> 对 <strong>balance</strong> 的操作会不会有冲突？这个问题现在我一直在里面绕着出不来。现在的打算是，最好能确认 <strong>correct-balance.py</strong> 的意义，然后把这个文件中的逻辑整合进 <strong>monitor.py</strong> 中。</p>
<p>目前还没有深入看 <strong>statistics.py</strong> 这个文件，这个文件的主要作用就是通过 <strong>1.2.9952</strong> 发布的喂价来更新数据库里的交易对的交易价格，另外就是统计一下交易数据。</p>
<p>纵观这三个文件，还有个疑问就是三个文件都在获取 <strong>global properties</strong>，且都更新数据库，那么这里面到底会不会有问题有冲突，这个还没有细看。</p>
<p>以上就是现有的收获了。接下来有两个方向，一个是继续看所有的 <strong>handler</strong>，把具体的处理逻辑都看完，然后再修复，另一个方向就是跳过细看 <strong>handler</strong>，直接去看看那个索引冲突的问题，强行把程序跑起来看看。</p>
<p>最后再附上一份我搜集的 <strong>object id</strong>：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Object Type</th>
</tr>
</thead>
<tbody><tr>
<td>1.1.x</td>
<td>base object</td>
</tr>
<tr>
<td>1.2.x</td>
<td>account object</td>
</tr>
<tr>
<td>1.3.x</td>
<td>asset object</td>
</tr>
<tr>
<td>1.4.x</td>
<td>force settlement object</td>
</tr>
<tr>
<td>1.5.x</td>
<td>committee member object</td>
</tr>
<tr>
<td>1.6.x</td>
<td>witness object</td>
</tr>
<tr>
<td>1.7.x</td>
<td>limit order object</td>
</tr>
<tr>
<td>1.8.x</td>
<td>call order object</td>
</tr>
<tr>
<td>1.9.x</td>
<td>custom object</td>
</tr>
<tr>
<td>1.10.x</td>
<td>proposal object</td>
</tr>
<tr>
<td>1.11.x</td>
<td>operation history object</td>
</tr>
<tr>
<td>1.12.x</td>
<td>withdraw permission object</td>
</tr>
<tr>
<td>1.13.x</td>
<td>vesting balance object</td>
</tr>
<tr>
<td>1.14.x</td>
<td>worker object</td>
</tr>
<tr>
<td>1.15.x</td>
<td>balance object</td>
</tr>
<tr>
<td>2.0.x</td>
<td>global_property_object</td>
</tr>
<tr>
<td>2.1.x</td>
<td>dynamic_global_property_object</td>
</tr>
<tr>
<td>2.3.x</td>
<td>asset_dynamic_data</td>
</tr>
<tr>
<td>2.4.x</td>
<td>asset_bitasset_data</td>
</tr>
<tr>
<td>2.5.x</td>
<td>account_balance_object</td>
</tr>
<tr>
<td>2.6.x</td>
<td>account_statistics_object</td>
</tr>
<tr>
<td>2.7.x</td>
<td>transaction_object</td>
</tr>
<tr>
<td>2.8.x</td>
<td>block_summary_object</td>
</tr>
<tr>
<td>2.9.x</td>
<td>account_transaction_history_object</td>
</tr>
<tr>
<td>2.10.x</td>
<td>blinded_balance_object</td>
</tr>
<tr>
<td>2.11.x</td>
<td>chain_property_object</td>
</tr>
<tr>
<td>2.12.x</td>
<td>witness_schedule_object</td>
</tr>
<tr>
<td>2.13.x</td>
<td>budget_record_object</td>
</tr>
<tr>
<td>2.14.x</td>
<td>special_authority_object</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/12/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/49/">49</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/14/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2009 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ETY001</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/ety001" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
